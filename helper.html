<!DOCTYPE html>
<html>

<head>
    <title>로봇킹 Log and Helper</title>
    <link rel="shortcut icon" href="/img/favicon.ico" />

    <meta charset="utf-8" />
    <meta name="description" content="overview &amp; stats" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- basic styles -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />

    <!--[if IE 7]>
          <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />
        <![endif]-->

    <!-- page specific plugin styles -->
    <link rel="stylesheet" href="assets/css/jquery-ui-1.10.3.custom.min.css" />
    <link rel="stylesheet" href="assets/css/chosen.css" />
    <link rel="stylesheet" href="assets/css/datepicker.css" />

    <!-- fonts -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" />
    <!-- ace styles -->
    <link rel="stylesheet" href="assets/css/ace.min.css" />
    <link rel="stylesheet" href="assets/css/ace-skins.min.css" />

    <style>
    .btn {
        line-height : 18px;
    }
    .modify-btn {
        margin-bottom:10px;
    }
    </style>

    <!--[if lte IE 8]>
          <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
        <![endif]-->

    <!--inline styles related to this page-->

    <!--basic scripts-->
    <!--[if !IE]>-->
    <script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
    </script>
    <!--<![endif]-->

    <!--[if IE]>
        <script type="text/javascript">
         window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"/script>");
        </script>
        <![endif]-->

    <script type="text/javascript">
    if ("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="assets/js/bootstrap.min.js"></script>

    <!--page specific plugin scripts-->

    <script src="assets/js/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="assets/js/jquery.ui.touch-punch.min.js"></script>
    <script src="assets/js/markdown/markdown.min.js"></script>
    <script src="assets/js/markdown/bootstrap-markdown.min.js"></script>
    <script src="assets/js/jquery.hotkeys.min.js"></script>
    <script src="assets/js/bootstrap-wysiwyg.min.js"></script>
    <script src="assets/js/bootbox.min.js"></script>
    <script src="assets/js/date-time/bootstrap-datepicker.min.js"></script>
    <script src="assets/js/jquery.validate.min.js"></script>

    <!--ace scripts-->
    <script src="assets/js/ace-elements.min.js"></script>
    <script src="assets/js/ace.min.js"></script>

    <!-- ajaxform -->
    <script src="http://malsup.github.com/jquery.form.js"></script>

    <!-- common js -->
    <script src="js/jquery-cookie.js"></script>
    <script src="js/common.js"></script>
    <script src="js/validate.js"></script>
    <script src="js/jquery-dataTable.js"></script>
    <script src="js/jquery-dataTable-bootstrap.js"></script>
    <script src="js/jquery-blockui.js"></script>
</head>

<body>
    <div class="navbar">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a href="log-auth.html" class="brand">
                    <small>
                        <i class="icon-leaf"></i>
                        로봇킹 Log and Helper
                    </small>
                </a>

                <!--/.ace-nav-->
            </div>
            <!--/.container-fluid-->
        </div>
        <!--/.navbar-inner-->
    </div>

    <div class="main-container container-fluid">
        <a class="menu-toggler" id="menu-toggler" href="#">
            <span class="menu-text"></span>
        </a>

        <div class="sidebar" id="sidebar">

            <ul class="nav nav-list">
                <li id="side-charge">
                    <a href="javascript:;" class="dropdown-toggle">
                        <i class="icon-desktop"></i>
                        <span class="menu-text">로그검색
                            <span class="badge badge-primary "></span>
                        </span>
                    </a>
                    <ul class="submenu">
                        <li id="side-log-charge">
                            <a href="log-charge.html">
                                <i class="icon-double-angle-right"></i>
                                결제 로그
                            </a>
                        </li>
                        <li id="side-log-etc">
                            <a href="log-etc.html">
                                <i class="icon-double-angle-right"></i>
                                기타 로그
                            </a>
                        </li>
                    </ul>
                </li>
                <li id="side-helper">
                    <a href="javascript:;" class="dropdown-toggle">
                        <i class="icon-edit"></i>
                        <span class="menu-text">Game Helper
                            <span class="badge badge-primary "></span>
                        </span>
                    </a>
                </li>
            </ul>
            <!--/.nav-list-->
            <div class="sidebar-collapse" id="sidebar-collapse">
                <i class="icon-double-angle-left"></i>
            </div>
        </div>
        <div class="main-content">
            <div class="page-content">
                <div class="page-header position-relative">
                    <h1>Helper 기준 정보</h1>
                </div>
                <!--/.page
                -header-->

                </table>
                <div class="row-fluid">
                    <div class="control-group">
                        <label for="standard-stage" class="control-label">기준 스테이지</label>
                        <div class="controls">
                            <input type="text" class="input-small" name="standard-stage" id="inp-standard-stage">

                        </div>
                    </div>
                    <div class="control-group">
                        <label for="standard-score" class="control-labe">기준 점수</label>
                        <div class="controls">
                            <input type="text" class="input-small" name="standard-score" id="inp-standard-score">
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="standard-score" class="control-labe">고득점자 Helper 적용 카운트</label>
                        <div class="controls">
                            <input type="text" class="input-small" id="high-min">~
                            <input type="text" class="input-small" id="high-max">
                        </div>
                    </div>
                    <div class="control-group">
                        <label for="standard-score" class="control-labe">저득점자 Helper 적용 카운트</label>
                        <div class="controls">
                            <input type="text" class="input-small" id="low-min">~
                            <input type="text" class="input-small" id="low-max">
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls">
                            <button class="btn btn-info modify-btn" type="button" id="mod-cancel">취소</button>
                            <button class="btn btn-success modify-btn" type="button" id="mod-helper">변경</button>
                        </div>
                    </div>
                </div>
                <!-- /.row-fluid -->
            </div>
            <!-- /.page-content -->
        </div>
        <!--/.main-content-->
        <script>
        var paramData = {};

        $(function() {
            $("#side-helper").addClass("active");
            if (isEmpty($.cookie("helper-auth"))) {
                alert("미인증 상태입니다.");
                location.href = "log-auth.html";
                return false;
            }

            // 최초 Helper 정보 setting            
            $.ajax({
                type: "POST",
                dataType: "json",
                url: api.getHelperSystemStandardInfo,
                contentType: "application/x-www-form-urlencoded; charset=utf-8",
                error: function(xhr, textStatus, errorThrown) {
                    alert(errorThrown);
                }, // end error
                success: function(response) {
                    $.each(response, function() {
                        $("#inp-standard-stage").val(this.HelperSystem_LimitStage);
                        $("#inp-standard-score").val(this.HelperSystem_StandardScore);
                        $("#high-min").val(this.HelperSystem_StandardScore_Better_Min);
                        $("#high-max").val(this.HelperSystem_StandardScore_Better_Max);
                        $("#low-min").val(this.HelperSystem_StandardScore_Lower_Min);
                        $("#low-max").val(this.HelperSystem_StandardScore_Lower_Max);


                    }) // end each
                } // end success
            }); // end ajax

            // 스테이지 변경 버튼 이벤트
            $("#mod-helper").on("click", function() {

                var betterMin, betterMax, lowerMin, lowerMax, limitStage, standardScore;

                betterMin = $("#high-min").val();
                betterMax = $("#high-max").val();
                lowerMin = $("#low-min").val();
                lowerMax = $("#low-max").val();
                limitStage = $("#inp-standard-stage").val();
                standardScore = $("#inp-standard-score").val();

                /*
                    validate 전부 숫자이여야 함
                    1 이하의 값은 입력 불가함
                    min 값은 max 값보다 작아야함
                */
                if (isNaturalNum(betterMax) && isNaturalNum(betterMin) && isNaturalNum(lowerMin) && isNaturalNum(lowerMax) && isNaturalNum(limitStage) && isNaturalNum(standardScore)) {
                    if (parseInt($("#high-min").val()) < 1 || parseInt($("#high-max").val()) < 1 || parseInt($("#low-max").val()) < 1 || parseInt($("#low-min").val()) < 1 || parseInt($("#inp-standard-stage").val()) < 1 || parseInt($("#inp-standard-score").val()) < 1) {
                        alert("변경 값들은 1 이상 이여야 합니다.");
                        return false;
                    }

                    if (betterMin >= betterMax) {
                        alert("고득점자 Min 값은 Max 값보다 작아야 합니다.");
                        return false;
                    }

                    if (lowerMin >= lowerMax) {
                        alert("저득점자 Min 값은 Max 값보다 작아야 합니다.");
                        return false;
                    }
                } else {
                    alert("입력값은 숫자만 가능 합니다.")
                    return false;
                }

                if (confirm("Helper 정보를 변경 하시겠습니까?")) {
                    paramData.gmid = "1";
                    paramData.comment = "helper 변경";
                    paramData.limitStage = limitStage;
                    paramData.standardScore = standardScore;
                    paramData.hs_ss_better_min =betterMin;
                    paramData.hs_ss_better_max = betterMax;
                    paramData.hs_ss_lower_min = lowerMin;
                    paramData.hs_ss_lower_max = lowerMax;

                    $.ajax({
                        type: "POST",
                        data: paramData,
                        url: api.setHelperSystemStandardInfo,
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        error: function(xhr, textStatus, errorThrown) {
                            alert(errorThrown);
                        }, // end error
                        success: function(response) {
                            if (response == "True") {
                                alert("변경 완료!");
                                location.reload();
                            } else {
                                alert("변경 실패");
                            }
                        } // end success
                    }); // end ajax
                } // end confirm
            }); // end 스테이지 변경 버튼 이벤트

            $("#mod-cancel").on("click", function() {
                location.reload();
            });
        });
        </script>
</body>

</html>
